#!/usr/bin/env node
"use strict";

var Compiler = require('../lib/compiler')
  , nomnom = require('nomnom');

var opts = nomnom
  .option('file', {
    position: 0,
    help: 'input file',
    required: true
  })
  .option('basedir', {
    abbr: 'b',
    help: 'base directory',
    default: process.cwd()
  })
  .parse();

var compiler = new Compiler({
  basedir: opts.basedir
});

compiler.compile(opts.file, function(err, fn) {
  if (err) {
    console.trace(err);
    process.exit(1);
  }
  process.stdout.write(fn.toString());
  process.exit(0);
});
